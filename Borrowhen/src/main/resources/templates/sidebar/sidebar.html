<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Sidebar</title>
<link rel="stylesheet" th:href="@{css/sidebar.css}" />
</head>
<body>
	<nav th:fragment="content">
		<img th:src="@{/images/logo.png}" alt="logo">
		<hr class="soft-gradient">
		
		<!--  LENDER SIDEBAR  -->	
		
		<th:block sec:authorize="hasAuthority('BORROWER')">
			<section>
				<p>MAIN</p>
				<a th:href="@{/dashboard}" class="option">
					<span class="active"><img th:src="@{/images/dashboard.png}"> DASHBOARD</span>
				</a>
				<a th:href="@{/inventory}" class="option">
					<span><img th:src="@{/images/supplies.png}"> INVENTORIES</span>
				</a>
				<a th:href="@{/request}" class="option">
					<span><img th:src="@{/images/supplies.png}"> REQUESTS</span>
				</a>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>HISTORY</p>
				<div class="option">
					<span><img th:src="@{/images/history.png}"> HISTORY</span>
				</div>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>PAYMENT</p>
				<div class="option">
					<span><img th:src="@{/images/history.png}"> PAYMENT</span>
				</div>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>NOTIFICATION</p>
				<div class="option">
					<span><img th:src="@{/images/history.png}"> NOTIFICATIONS</span>
				</div>
			</section>
		</th:block>	
		
		
		<!--  LENDER SIDEBAR  -->	
		
		<th:block sec:authorize="hasAuthority('LENDER')">
			<section>
				<p>MAIN</p>
				<a th:href="@{/lender/dashboard}" class="option">
					<span class="active"><img th:src="@{/images/dashboard.png}"> DASHBOARD</span>
				</a>
				<a th:href="@{/lender/inventory}" class="option">
					<span><img th:src="@{/images/supplies.png}"> INVENTORY</span>
				</a>
				<a th:href="@{/lender/inventory}" class="option">
					<span><img th:src="@{/images/supplies.png}"> REQUEST</span>
				</a>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>HISTORY</p>
				<div class="option">
					<span><img th:src="@{/images/history.png}"> HISTORY</span>
				</div>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>PAYMENT</p>
				<div class="option">
					<span><img th:src="@{/images/history.png}"> PAYMENT</span>
				</div>
			</section>
		</th:block>	
			
			
		<!--  ADMIN SIDEBAR  -->		
			
		<th:block sec:authorize="hasAuthority('ADMIN')">
		    <section>
		        <p>MAIN</p>
		        <a th:href="@{/admin/dashboard}" class="option">
		            <span class="active"><img th:src="@{/images/dashboard.png}"> DASHBOARD</span>
		        </a>
		        <a th:href="@{/admin/inventory}" class="option">
		            <span><img th:src="@{/images/supplies.png}"> ALL INVENTORY</span>
		        </a>
		        <div class="option">
		            <span><img th:src="@{/images/request.png}"> ALL REQUEST</span>
		        </div>
		    </section>
		    <hr class="soft-gradient">
		    
		    <section>
		        <p>HISTORY</p>
		        <div class="option">
		            <span><img th:src="@{/images/history.png}"> HISTORY</span>
		        </div>
		    </section>
		    <hr class="soft-gradient">
		    
		    <section>
		        <p>LOGS</p>
		        <div class="option">
		            <span><img th:src="@{/images/history.png}"> REQUEST LOGS</span>
		        </div>
		        <div class="option">
		            <span><img th:src="@{/images/history.png}"> PAYMENT LOGS</span>
		        </div>
		    </section>
		    <hr class="soft-gradient">
		    
		    <section>
		        <p>PAYMENT</p>
		        <div class="option">
		            <span><img th:src="@{/images/history.png}"> PAYMENT</span>
		        </div>
		    </section>
		    <hr class="soft-gradient">
		    
		    <section class="admin-settings">
		        <p>USERS</p>
		        <a th:href="@{/admin/user}" class="option">
		            <span><img th:src="@{/images/friends.png}"> USER</span>
		        </a>
		    </section>
		</th:block>

		<script>
			document.addEventListener("DOMContentLoaded", () => {
			  const currentPath = window.location.pathname.toLowerCase();
			
			  // "enum" style mapping (URL keyword → menu keyword)
			  const menuMap = {
			    "/admin/dashboard": "dashboard",
			    "/admin/inventory": "inventory",
			    "/admin/user": "user",
			    "/lender/inventory": "inventory",
			    "/inventory": "inventory",
			    "/dashboard": "dashboard",
			    "/request": "request",
			    "/payment": "payment",
			    "/history": "history"
			  };
			
			  // remove any existing active classes
			  document.querySelectorAll(".option p.active").forEach(el => el.classList.remove("active"));
			
			  let matched = false;
			
			  for (const [url, key] of Object.entries(menuMap)) {
			    if (currentPath.startsWith(url)) {
			      document.querySelectorAll(".option p").forEach(p => {
			        if (p.textContent.toLowerCase().includes(key)) {
			          p.classList.add("active");
			          matched = true;
			        }
			      });
			      break;
			    }
			  }
			
			  // fallback → highlight first option
			  if (!matched) {
			    const first = document.querySelector(".option p");
			    if (first) first.classList.add("active");
			  }
			});
			</script>

	</nav>
</body>
</html>