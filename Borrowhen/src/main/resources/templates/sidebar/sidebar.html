<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Sidebar</title>
<link rel="stylesheet" th:href="@{css/sidebar.css}" />
</head>
<body>
	<nav th:fragment="content">
		<img th:src="@{/images/logo.png}" alt="logo">
		<hr class="soft-gradient">
		
		<!--  LENDER SIDEBAR  -->	
		
		<div class="container-msg" id="msgContainer" >
			<div class="success-msg" th:if="${successMsg != null}">
				<div class="icon-msg">
					<img th:src="@{/images/check.png}" alt="success"/>
				</div>
				<div class="content-msg">
					<span class="header-msg">SUCCESS</span>
					<span class="body-msg" th:text="${successMsg}"></span>
				</div>
				<div class="progress-bar"></div>
			</div>
			<div class="error-msg" th:if="${errorMsg != null}">
				<div class="icon-msg">
					<img th:src="@{/images/check.png}" alt="success"/>
				</div>
				<div class="content-msg">
					<span class="header-msg">ERROR</span>
					<span class="body-msg" th:text="${errorMsg}"></span>
				</div>
				<div class="progress-bar"></div>
			</div>
		</div>
		
		<th:block sec:authorize="hasAuthority('BORROWER')">
			<section>
				<p>MAIN</p>
				<a th:href="@{/dashboard}" class="option">
					<span class="active"><img th:src="@{/images/dashboard.png}"> DASHBOARD</span>
				</a>
				<a th:href="@{/inventory}" class="option">
					<span><img th:src="@{/images/supplies.png}"> INVENTORIES</span>
				</a>
				<a th:href="@{/request}" class="option">
					<span><img th:src="@{/images/supplies.png}"> REQUESTS</span>
				</a>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>HISTORY</p>
				<div class="option">
					<span><img th:src="@{/images/history.png}"> HISTORY</span>
				</div>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>PAYMENT</p>
				<div class="option">
					<span><img th:src="@{/images/wallet.png}"> PAYMENT</span>
				</div>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>NOTIFICATION</p>
				<div class="option">
					<span><img th:src="@{/images/reminder.png}"> NOTIFICATIONS</span>
				</div>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>GUIDELINES</p>
				<a th:href="@{/support}" class="option">
					<span><img th:src="@{/images/rules.png}"> SUPPORT</span>
				</a>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>SUPPORT</p>
				<a th:href="@{/guidelines/rules}" class="option">
					<span><img th:src="@{/images/rules.png}"> RULES</span>
				</a>
			</section>
		</th:block>	
		
		
		<!--  LENDER SIDEBAR  -->	
		
		<th:block sec:authorize="hasAuthority('LENDER')">
			<section>
				<p>MAIN</p>
				<a th:href="@{/lender/dashboard}" class="option">
					<span class="active"><img th:src="@{/images/dashboard.png}"> DASHBOARD</span>
				</a>
				<a th:href="@{/lender/inventory}" class="option">
					<span><img th:src="@{/images/supplies.png}"> INVENTORY</span>
				</a>
				<a th:href="@{/lender/inventory}" class="option">
					<span><img th:src="@{/images/supplies.png}"> REQUEST</span>
				</a>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>HISTORY</p>
				<div class="option">
					<span><img th:src="@{/images/history.png}"> HISTORY</span>
				</div>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>PAYMENT</p>
				<div class="option">
					<span><img th:src="@{/images/history.png}"> PAYMENT</span>
				</div>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>SUPPORT</p>
				<a th:href="@{/support}" class="option">
					<span><img th:src="@{/images/rules.png}"> SUPPORT</span>
				</a>
			</section>
			<hr class="soft-gradient">
			<section>
				<p>GUIDELINES</p>
				<a th:href="@{/guidelines/rules}" class="option">
					<span><img th:src="@{/images/rules.png}"> RULES</span>
				</a>
			</section>
		</th:block>	
			
			
		<!--  ADMIN SIDEBAR  -->		
			
		<th:block sec:authorize="hasAuthority('ADMIN')">
		    <section>
		        <p>MAIN</p>
		        <a th:href="@{/admin/dashboard}" class="option">
		            <span class="active"><img th:src="@{/images/dashboard.png}"> DASHBOARD</span>
		        </a>
		        <a th:href="@{/admin/inventory}" class="option">
		            <span><img th:src="@{/images/supplies.png}"> ALL INVENTORY</span>
		        </a>
		        <a th:href="@{/admin/request}" class="option">
		            <span><img th:src="@{/images/request.png}"> ALL REQUEST</span>
		        </a>
		    </section>
		    <hr class="soft-gradient">
		    
		    <section>
		        <p>HISTORY</p>
		        <div class="option">
		            <span><img th:src="@{/images/history.png}"> HISTORY</span>
		        </div>
		    </section>
		    <hr class="soft-gradient">
		    
		    <section>
		        <p>LOGS</p>
		        <div class="option">
		            <span><img th:src="@{/images/history.png}"> REQUEST LOGS</span>
		        </div>
		        <div class="option">
		            <span><img th:src="@{/images/history.png}"> PAYMENT LOGS</span>
		        </div>
		    </section>
		    <hr class="soft-gradient">
		    
		    <section>
		        <p>PAYMENT</p>
		        <div class="option">
		            <span><img th:src="@{/images/history.png}"> PAYMENT</span>
		        </div>
		    </section>
		    <hr class="soft-gradient">
		    
		    <section class="admin-settings">
		        <p>USERS</p>
		        <a th:href="@{/admin/user}" class="option">
		            <span><img th:src="@{/images/friends.png}"> USER</span>
		        </a>
		    </section>
		    
		    <hr class="soft-gradient">
		    
		    <section class="admin-settings">
		        <p>ADMIN SETTINGS</p>
		        <a th:href="@{/admin/settings}" class="option">
		            <span><img th:src="@{/images/friends.png}"> ADMIN SETTINGS</span>
		        </a>
		    </section>
		</th:block>

		<script>
		document.addEventListener("DOMContentLoaded", () => {
			const currentPath = window.location.pathname.toLowerCase().replaceAll("/", "");

			  // remove any existing active classes
			  document.querySelectorAll(".option span.active").forEach(el =>
			    el.classList.remove("active")
			  );

			  // loop through each <a class="option">
			  document.querySelectorAll(".option").forEach(option => {
				  const href = option.tagName === "A" && option.getAttribute("href")
				    ? option.getAttribute("href").toLowerCase().replaceAll("/", "")
				    : "";

				  if (option.tagName === "A" && currentPath.includes(href)) {
				    const span = option.querySelector("span");
				    if (span) {
				      span.classList.add("active");
				    }
				  }
				});

			});

			</script>

	</nav>
</body>
</html>